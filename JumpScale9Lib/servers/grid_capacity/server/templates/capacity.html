{% extends "layout.html" %}
  {% block body %}
    <main role="main">

      <div class="container">
        <h2>Search for capacity</h2>
        <form action="/" method="get">
          <div class="form-group">
              <label for="formCRU">Minimum CPU unit : <span class="badge badge-pill badge-primary"><span id=formCRUValue></span> CPU</span></span></label>
              <input type="range" class="form-control-range" id="formCRU" name="cru" value="{{form['cru']}}" step=1>
          </div>
          <div class="form-group">
            <label for="formMRU">Minimum memory unit : <span class="badge badge-pill badge-primary"><span id=formMRUValue></span> GiB</span></span></label>
            <input type="range" class="form-control-range" id="formMRU" name="mru" value="{{form['mru']}}" step=1 onchange="">
          </div>
          <div class="form-group">
              <label for="formHRU">minimum HDD unit : <span class="badge badge-pill badge-primary"><span id=formHRUValue></span> GiB</span></span></label>
              <input type="range" class="form-control-range" id="formHRU" name="hru" value="{{form['hru']}}" step=1>
          </div>
          <div class="form-group">
              <label for="formSRU">minimum SSD unit : <span class="badge badge-pill badge-primary"><span id=formSRUValue></span> GiB</span></span></label>
              <input type="range" class="form-control-range" id="formSRU" name="sru" value="{{form['sru']}}" step=1>
          </div>
          <div class="form-group">
              <label for="formCountry">filter by country :</label>
              <select class="form-control" id="formCountry"  name="country">
                <option></option>
                {% for country in countries %}
                {% if form['country'] == country %}
                <option selected>{{country}}</option>
                {% else %}
                <option>{{country}}</option>
                {% endif %}
                {% endfor %}
              </select>
            </div>
          <div class="form-group">
              <button type="submit" class="btn btn-primary">Search</button>
              <a class="btn btn-secondary" href="/">Reset</a>
          </div>
        </form>
      </div>

      {% if nodes %}
      <div class="container">
        <div class="ro">
          {% if products|length > 1 %}
            <p>Node found: {{nodes|length}}</p>
          {% else %}
            <p>Nodes found: {{nodes|length}}</p>
          {% endif %}
        </div>
        <div class="row">

          <table class="table  table-striped table-hover">
            <thead class="thead-light">
              <tr>
                <th scope="col">Node ID <input</th>
                <!-- <th scope="col">Farmer ID</th> -->
                <th scope="col">Continent</th>
                <th scope="col">Country</th>
                <th scope="col">City</th>
                <th scope="col">CRU</th>
                <th scope="col">MRU</th>
                <th scope="col">HRU</th>
                <th scope="col">SRU</th>
              </tr>
            </thead>
            <tbody>
              {% for node in nodes %}
              <tr data-toggle="modal" data-target="#nodeDetailModal{{node['node_id']}}" class="nodeItem">
                <td>{{ node['node_id'] }}</td>
                <!-- <td>{{ node['farmer'] }}</td> -->
                <td>{{ node['location']['continent'] }}</td>
                <td>{{ node['location']['country'] }}</td>
                <td>{{ node['location']['city'] }}</td>
                <td>{{ node['cru'] }}</td>
                <td>{{ node['mru'] }}</td>
                <td>{{ node['hru'] }}</td>
                <td>{{ node['sru'] }}</td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      </div>
      {% endif %}

    </main>

    <!-- Modal -->
    {% for node in nodes %}
    <div class="modal fade" id="nodeDetailModal{{node['node_id']}}" tabindex="-1" role="dialog" aria-labelledby="nodeDetailModalLabel{{node['node_id']}}" aria-hidden="true">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="nodeDetailModalLabel">Node detail</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <p>Node 0-robot address: <code>{{node['robot_address']}}</code></p>
            <p>0-OS version: <code>{{node['os_version']}}</code></p>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
          </div>
        </div>
      </div>
    </div>
    {% endfor %}
  {% endblock %}